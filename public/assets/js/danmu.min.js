!function(t){t.jQueryPlugin=function(i){t.fn[i]=function(e){var o=Array.prototype.slice.call(arguments,1);return this.length?this.each(function(){var n=t.data(this,i)||t.data(this,i,new cyntax.plugins[i](this,e)._init());"string"==typeof e&&(e=e.replace(/^_/,""),n[e]&&n[e].apply(n,o))}):void 0}}}(jQuery);var cyntax={plugins:{}};!function(){function t(){return(new Date).getTime()}var i=jQuery,e="jQuery.pause",o=1,n=i.fn.animate,s={};i.fn.animate=function(a,r,p,h){var d=i.speed(r,p,h);return d.complete=d.old,this.each(function(){this[e]||(this[e]=o++);var r=i.extend({},d);n.apply(i(this),[a,i.extend({},r)]),s[this[e]]={run:!0,prop:a,opt:r,start:t(),done:0}})},i.fn.pause=function(){return this.each(function(){this[e]||(this[e]=o++);var n=s[this[e]];n&&n.run&&(n.done+=t()-n.start,n.done>n.opt.duration?delete s[this[e]]:(i(this).stop(),i(this).stop(),i(this).stop(),n.run=!1))})},i.fn.resume=function(){return this.each(function(){this[e]||(this[e]=o++);var a=s[this[e]];a&&!a.run&&(a.opt.duration-=a.done,a.done=0,a.run=!0,a.start=t(),n.apply(i(this),[a.prop,i.extend({},a.opt)]))})}}(),function(t){cyntax.plugins.timer=function(i,e){this.$this=t(i),this.options=t.extend({},this.defaults,e),this.timer_info={id:null,index:null,state:0}},cyntax.plugins.timer.prototype={defaults:{delay:1e3,repeat:!1,autostart:!0,callback:null,url:"",post:""},_init:function(){return this.options.autostart&&(this.timer_info.state=1,this.timer_info.id=setTimeout(t.proxy(this._timer_fn,this),this.options.delay)),this},_timer_fn:function(){"function"==typeof this.options.callback?t.proxy(this.options.callback,this.$this).call(this,++this.timer_info.index):"string"==typeof this.options.url&&(ajax_options={url:this.options.url,context:this,type:"string"==typeof this.options.post&&""!=typeof this.options.post==""?"POST":"GET",success:function(t,i,e){this.$this.html(t)}},"string"==typeof this.options.post&&""!=typeof this.options.post&&(ajax_options.data=this.options.post),t.ajax(ajax_options)),this.options.repeat&&1==this.timer_info.state&&("boolean"==typeof this.options.repeat||parseInt(this.options.repeat)>this.timer_info.index)?this.timer_info.id=setTimeout(t.proxy(this._timer_fn,this),this.options.delay):this.timer_id=null},start:function(){0==this.timer_info.state&&(this.timer_info.index=0,this.timer_info.state=1,this.timer_id=setTimeout(t.proxy(this._timer_fn,this),this.options.delay))},stop:function(){1==this.timer_info.state&&this.timer_info.id&&(clearTimeout(this.timer_info.id),this.timer_id=null),this.timer_info.state=0},pause:function(){1==this.timer_info.state&&this.timer_info.id&&clearTimeout(this.timer_info.id),this.timer_info.state=0},resume:function(){this.timer_info.state=1,this.timer_id=setTimeout(t.proxy(this._timer_fn,this),this.options.delay)}},t.jQueryPlugin("timer")}(jQuery),function(t){function i(i,o){return this.each(function(){var n=t(this),s=t.extend({},e.DEFAULTS,"object"==typeof i&&i),a=n.data("danmu"),r="string"==typeof i?i:0/0;a||n.data("danmu",a=new e(this,s)),r&&a[r](o)})}var e=function(i,e){this.$element=t(i),this.options=e,t(i).data("nowtime",0),t(i).data("danmu_array",e.danmuss),t(i).data("opacity",e.opacity),t(i).data("paused",1),t(i).data("topspace",0),t(i).data("bottomspace",0),this.$element.css({position:"absolute",left:this.options.left,top:this.options.top,width:this.options.width,height:this.options.height,"z-index":this.options.zindex,color:e.default_font_color,overflow:"hidden"});var o=this.$element.height(),n=parseInt(o/e.font_size_big),s=new Array;t("<div class='timer71452'></div>").appendTo(this.$element),this.$timer=t(".timer71452"),this.$timer.timer({delay:100,repeat:e.sumtime,autostart:!1,callback:function(a){if(o=t(i).height(),t(i).data("danmu_array")[t(i).data("nowtime")])for(var r=t(i).data("danmu_array")[t(i).data("nowtime")],p=0;p<r.length;p++){var h="<div class='flying flying2' id='linshi'></div>";if(t(i).append(h),t("#linshi").text(r[p].text),t("#linshi").css({color:r[p].color,"text-shadow":" 0px 0px 2px #000000","-moz-opacity":t(i).data("opacity"),opacity:t(i).data("opacity"),"white-space":"nowrap","font-weight":"bold","font-family":"SimHei","font-size":e.font_size_big}),r[p].color<"#777777"&&t("#linshi").css({"text-shadow":" 0px 0px 2px #FFFFFF"}),r[p].hasOwnProperty("isnew")&&t("#linshi").css({border:"2px solid "+r[p].color}),0==r[p].size&&t("#linshi").css("font-size",e.font_size_small),0==r[p].position){for(var d=parseInt(n*Math.random());s.indexOf(d)>=0;)var d=parseInt(n*Math.random());s.push(d),s.length==n&&(s=new Array,n=parseInt(o/e.font_size_big));var m=d*e.font_size_big;t("#linshi").css({position:"absolute",top:m,left:e.width});var u="fly"+parseInt(o*Math.random()).toString();t("#linshi").attr("id",u),t("#"+u).animate({left:3*-t(this).width()},e.speed,function(){t(this).remove()})}else if(1==r[p].position){var f="top"+parseInt(1e4*Math.random()).toString();t("#linshi").attr("id",f),t("#"+f).css({width:e.width,"text-align":"center",position:"absolute",top:5+t(i).data("topspace")}),t(i).data("topspace",t(i).data("topspace")+e.font_size_big),t("#"+f).fadeTo(e.top_botton_danmu_time,t(i).data("opacity"),function(){t(this).remove(),t(i).data("topspace",t(i).data("topspace")-e.font_size_big)})}else if(2==r[p].position){var l="top"+parseInt(1e4*Math.random()).toString();t("#linshi").attr("id",l),t("#"+l).css({width:e.width,"text-align":"center",position:"absolute",bottom:0+t(i).data("bottomspace")}),t(i).data("bottomspace",t(i).data("bottomspace")+e.font_size_big),t("#"+l).fadeTo(e.top_botton_danmu_time,t(i).data("opacity"),function(){t(this).remove(),t(i).data("bottomspace",t(i).data("bottomspace")-e.font_size_big)})}}t(i).data("nowtime",t(i).data("nowtime")+1)}})};e.DEFAULTS={left:0,top:0,height:360,width:640,zindex:100,speed:2e4,sumtime:65535,danmuss:{},default_font_color:"#FFFFFF",font_size_small:16,font_size_big:24,opacity:"0.9",top_botton_danmu_time:6e3},e.prototype.danmu_start=function(){this.$timer.timer("start"),this.$element.data("paused",0)},e.prototype.danmu_stop=function(){this.$timer.timer("stop"),t(".flying").remove(),nowtime=0,this.$element.data("paused",1),this.$element.data("nowtime",0)},e.prototype.danmu_pause=function(){this.$timer.timer("pause"),t(".flying").pause(),this.$element.data("paused",1)},e.prototype.danmu_resume=function(){this.$timer.timer("resume"),t(".flying").resume(),this.$element.data("paused",0)},e.prototype.danmu_hideall=function(){t(".flying").css({opacity:0})},e.prototype.add_danmu=function(t){this.$element.data("danmu_array")[t.time]?this.$element.data("danmu_array")[t.time].push(t):(this.$element.data("danmu_array")[t.time]=new Array,this.$element.data("danmu_array")[t.time].push(t))},t.fn.danmu=i,t.fn.danmu.Constructor=e}(jQuery);